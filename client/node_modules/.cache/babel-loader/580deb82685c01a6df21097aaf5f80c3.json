{"ast":null,"code":"import _objectSpread from\"/Users/balajikamalanathan/Documents/GitHub/react-node-stripe-payment/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/balajikamalanathan/Documents/GitHub/react-node-stripe-payment/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from\"react\";import style from\"./PaymentScreen.module.scss\";import{postRequest}from\"../utils/api\";import PaymentForm from\"./PaymentForm\";import ListPaymentMethods from\"./ListPaymentMethods\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function PaymentScreen(){var _useState=useState({}),_useState2=_slicedToArray(_useState,2),selectedMethod=_useState2[0],setSelectedMethod=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),paymentIntent=_useState4[0],setPaymentIntent=_useState4[1];var _useState5=useState({prePayment:true,paymentMethods:false,paymentForm:false}),_useState6=_slicedToArray(_useState5,2),activeScreen=_useState6[0],setActiveScreen=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),amount=_useState8[0],setAmount=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),amountError=_useState10[0],setAmountError=_useState10[1];function handleSelectCard(method){setSelectedMethod(method);createPaymentIntent(method.id);}function createPaymentIntent(selectedPaymentMethodId){var data={paymentMethod:selectedPaymentMethodId,amount:amount};postRequest(\"/payment/create\",_objectSpread({},data)).then(function(resp){setPaymentIntent(resp.data);setActiveScreen({paymentForm:false,paymentMethods:true});changeActiveScreen(\"paymentForm\");}).catch(function(err){console.log(err);});}function changeActiveScreen(screen){var toUpdate={prePayment:false,paymentMethods:false,paymentForm:false};toUpdate[screen]=true;setActiveScreen(toUpdate);}function handleChangeAmount(e){var value=e.target.value;if(!/^[1-9]*$/.test(value)){setAmountError('Please enter valid amount');}else{setAmount(function(prev){return Number(value);});setAmountError('');}}function handleClickMakePayment(){changeActiveScreen(\"paymentMethods\");}return/*#__PURE__*/_jsxs(\"div\",{className:style.wrapper,children:[activeScreen.prePayment&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{className:style.innerWrapper,children:[/*#__PURE__*/_jsx(\"div\",{className:style.title,children:\"Make Payment\"}),/*#__PURE__*/_jsxs(\"div\",{className:style.row,children:[/*#__PURE__*/_jsx(\"label\",{children:\"Amount\"}),/*#__PURE__*/_jsx(\"input\",{onChange:handleChangeAmount,id:\"amount\",type:\"text\",name:\"name\",placeholder:\"Enter the amount\"}),amountError!==''&&/*#__PURE__*/_jsx(\"p\",{className:style.error,children:amountError})]}),/*#__PURE__*/_jsx(\"div\",{className:style.addressWrapper,children:/*#__PURE__*/_jsx(\"div\",{className:style.btnContainer,children:/*#__PURE__*/_jsx(\"button\",{onClick:handleClickMakePayment,children:\"Make Payment\"})})})]})}),activeScreen.paymentMethods&&/*#__PURE__*/_jsx(ListPaymentMethods,{handleSelectCard:handleSelectCard}),activeScreen.paymentForm&&paymentIntent&&/*#__PURE__*/_jsx(PaymentForm,{paymentIntent:paymentIntent,paymentMethod:selectedMethod})]});}","map":{"version":3,"names":["React","useState","style","postRequest","PaymentForm","ListPaymentMethods","jsx","_jsx","jsxs","_jsxs","PaymentScreen","_useState","_useState2","_slicedToArray","selectedMethod","setSelectedMethod","_useState3","_useState4","paymentIntent","setPaymentIntent","_useState5","prePayment","paymentMethods","paymentForm","_useState6","activeScreen","setActiveScreen","_useState7","_useState8","amount","setAmount","_useState9","_useState10","amountError","setAmountError","handleSelectCard","method","createPaymentIntent","id","selectedPaymentMethodId","data","paymentMethod","_objectSpread","then","resp","changeActiveScreen","catch","err","console","log","screen","toUpdate","handleChangeAmount","e","value","target","test","prev","Number","handleClickMakePayment","className","wrapper","children","innerWrapper","title","row","onChange","type","name","placeholder","error","addressWrapper","btnContainer","onClick"],"sources":["/Users/balajikamalanathan/Documents/GitHub/react-node-stripe-payment/client/src/components/PaymentScreen.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport style from \"./PaymentScreen.module.scss\";\nimport { postRequest } from \"../utils/api\";\n\nimport PaymentForm from \"./PaymentForm\";\nimport ListPaymentMethods from \"./ListPaymentMethods\";\n\nexport default function PaymentScreen() {\n  const [selectedMethod, setSelectedMethod] = useState({});\n  const [paymentIntent, setPaymentIntent] = useState(null);\n  const [activeScreen, setActiveScreen] = useState({\n    prePayment: true,\n    paymentMethods: false,\n    paymentForm: false,\n  });\n  const [amount, setAmount] = useState(0);\n  const [amountError, setAmountError] = useState('');\n\n  function handleSelectCard(method) {\n    setSelectedMethod(method);\n    createPaymentIntent(method.id);\n  }\n\n  function createPaymentIntent(selectedPaymentMethodId) {\n    const data = {\n      paymentMethod: selectedPaymentMethodId,\n      amount,\n    };\n    postRequest(`/payment/create`, {...data})\n      .then((resp) => {\n        setPaymentIntent(resp.data);\n        setActiveScreen({ paymentForm: false, paymentMethods: true });\n        changeActiveScreen(\"paymentForm\");\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  }\n\n  function changeActiveScreen(screen) {\n    let toUpdate = { prePayment: false, paymentMethods: false, paymentForm: false };\n    toUpdate[screen] = true;\n    setActiveScreen(toUpdate);\n  }\n\n  function handleChangeAmount(e) {\n    const { value } = e.target;\n    if(!(/^[1-9]*$/).test(value)) {\n      setAmountError('Please enter valid amount');\n    } else {\n      setAmount((prev) => Number(value));  \n      setAmountError('');\n    }\n  }\n\n  function handleClickMakePayment() {\n    changeActiveScreen(\"paymentMethods\");\n  }\n\n  return (\n    <div className={style.wrapper}>\n      {activeScreen.prePayment && \n      <div>\n            <div className={style.innerWrapper}>\n            <div className={style.title}>Make Payment</div>\n            <div className={style.row}>\n              <label>Amount</label>\n              <input\n                onChange={handleChangeAmount}\n                id=\"amount\"\n                type=\"text\"\n                name=\"name\"\n                placeholder=\"Enter the amount\"\n              />\n          {amountError !== '' &&\n            <p className={style.error}>{amountError}</p>\n          }\n            </div>\n            <div className={style.addressWrapper}>\n              <div className={style.btnContainer}>\n                <button onClick={handleClickMakePayment}>Make Payment</button>\n              </div>\n            </div>\n          </div>\n        </div>\n      }\n\n      {activeScreen.paymentMethods && <ListPaymentMethods handleSelectCard={handleSelectCard} />}\n\n      {activeScreen.paymentForm && paymentIntent && (\n        <PaymentForm paymentIntent={paymentIntent} paymentMethod={selectedMethod} />\n      )}\n    </div>\n  );\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}